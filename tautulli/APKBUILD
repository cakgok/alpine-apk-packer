pkgname=tautulli
pkgver=2.16.0
pkgrel=0
pkgdesc="A Python based monitoring and tracking tool for Plex Media Server"
url="https://tautulli.com"
arch="x86_64"
license="GPL-3.0-or-later"
depends="
  python3
  py3-setuptools
  py3-apscheduler
  py3-cryptography
  py3-openssl         
"
makedepends=""
subpackages="$pkgname-openrc::x86_64"
source="$pkgname-$pkgver.tar.gz::https://github.com/Tautulli/Tautulli/archive/v$pkgver.tar.gz
	tautulli.initd
	tautulli.confd
  tautulli.wrapper
	"
  
install="$pkgname.pre-install"
pkgusers="tautulli"
pkggroups="tautulli"
options="!check"
builddir="$srcdir/Tautulli-$pkgver"

package() {
    install -dm755 "$pkgdir/usr/lib/tautulli"
    install -dm755 "$pkgdir/usr/bin"
    install -dm755 "$pkgdir/var/lib/tautulli"
  	install -dm755 "$pkgdir/var/log/tautulli"
	  install -dm755 "$pkgdir/etc/tautulli"

    cp -a "$builddir"/. "$pkgdir/usr/lib/tautulli/"

    install -Dm755 "$srcdir"/$pkgname.wrapper "$pkgdir"/usr/bin/tautulli
    install -Dm755 "$srcdir"/$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
    install -Dm644 "$srcdir"/$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname

    echo "v$pkgver" > "$pkgdir"/usr/lib/tautulli/version.txt
    echo "master" > "$pkgdir"/usr/lib/tautulli/branch.txt
}

sha512sums="
afca14069ddffaa5a0a85d5085e49dda277327b3a81d5863d1550c5fa1e63eb6f9346aad95635bba556047faef34dc3dcfe321e72ff75ed60b3c387611ffcf9a  tautulli-2.16.0.tar.gz
101bb0295e7030aa346ea49a7a5b5be78449da3d58fbb02829aa1f30248a8f8ed5cf8e6aedb72c15d408226934bc8a214ac81481d7e0c0a8c4f365b7b74730cd  tautulli.initd
5d5327cc2bffd0917d0d6e3169b8cd7bf303d641d6710505e115f308bab39cb2e872bce923691041cc5c17261433365ab421da49809d69df5535895f33a4b57f  tautulli.confd
5a39ff68e1ba3a5ad187f155779cfa68a41fb98c8e4b516ac9f4a11ff8dfe86bc2e1afca43558f000d88a6c36d4ceb6066efad816ad283b76f9a94a1403f0f4b  tautulli.wrapper
"
