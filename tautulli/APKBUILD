pkgname=tautulli
pkgver=2.16.0
pkgrel=0
pkgdesc="A Python based monitoring and tracking tool for Plex Media Server"
url="https://tautulli.com"
arch="x86_64"
license="GPL-3.0-or-later"
depends="
  python3
  py3-setuptools
  py3-apscheduler
  py3-cryptography
  py3-openssl         
"
makedepends=""
subpackages="$pkgname-openrc::x86_64"
source="$pkgname-$pkgver.tar.gz::https://github.com/Tautulli/Tautulli/archive/v$pkgver.tar.gz
	tautulli.initd
	tautulli.confd
  tautulli.wrapper
	"
  
install="$pkgname.pre-install"
pkgusers="tautulli"
pkggroups="tautulli"
options="!check"
builddir="$srcdir/Tautulli-$pkgver"

package() {
    install -dm755 "$pkgdir/usr/lib/tautulli"
    install -dm755 "$pkgdir/usr/bin"
    install -dm755 "$pkgdir/var/lib/tautulli"
  	install -dm755 "$pkgdir/var/log/tautulli"
	  install -dm755 "$pkgdir/etc/tautulli"

    cp -a "$builddir"/. "$pkgdir/usr/lib/tautulli/"

    install -Dm755 "$srcdir"/tautulli.wrapper "$pkgdir"/usr/bin/tautulli
    install -Dm755 "$srcdir"/$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
    install -Dm644 "$srcdir"/$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname

	echo "v$pkgver" > "$pkgdir"/usr/lib/tautulli/version.txt
	echo "master" > "$pkgdir"/usr/lib/tautulli/branch.txt
}

sha512sums="
afca14069ddffaa5a0a85d5085e49dda277327b3a81d5863d1550c5fa1e63eb6f9346aad95635bba556047faef34dc3dcfe321e72ff75ed60b3c387611ffcf9a  tautulli-2.16.0.tar.gz
fcedc0e7ea768f9f53e08e8366dce685bd72ab8eb9e42318a131f9aa38b096053ffccdbabae87593ad81ffbd58775066662045b1800e994be1cf660954f57192  tautulli.initd
808e465c38a2362752c329ca0c0b2918fbe5798f71771efb4097ea95b7e9ad9833fef685d23a5017f14eda9035c58fb4a76a4c55d48d6151b60cdb3d0b031988  tautulli.confd
"
